# malware 2 solution

主要思路是逆向 exe 文件，根绝代码分析函数的作用，找到其中的 socket send/recv 函数，再配合流量问价来分析行为，找到 flag。

## 逆向分析

WinMain 是 exe 的入口函数，很简单：

```
int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
{
  sub_403610();
  return 0;
}
```

继续分析 sub_403610 函数的代码：

```
void sub_403610()
{
  void *Block; // [esp+0h] [ebp-10h]
  void *i; // [esp+4h] [ebp-Ch]

  while ( 1 )
  {
    if ( sub_402C00() )
    {
      for ( i = (void *)sub_40543B(1025); ; sub_402D40(i) )
      {
        memset(i, 0, 0x401u);
        if ( sub_401B70(s, (char *)i, 1024, 0, 0) == -1 )
          break;
      }
      Block = i;
      sub_405444(i);
    }
    sub_402CD0(Block, i);
  }
}
```
