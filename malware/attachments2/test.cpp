#include <stdio.h>
#include <windows.h>
#include <windef.h>
#include <wincrypt.h>
#include <string.h>

BYTE *sub_402820(HCRYPTPROV hProv, BYTE *pbData)
{
    HCRYPTHASH phHash;
    int v2;
    DWORD pdwDataLen = 32;
    BYTE v4[64];
    memset(v4, 0, sizeof(v4));

    CryptCreateHash(hProv, 0x800Cu, 0, 0, &phHash);
    v2 = strlen((const char *)pbData);
    CryptHashData(phHash, pbData, v2, 0);
    CryptGetHashParam(phHash, 2u, v4, &pdwDataLen, 0);

    printf("Src: %d\n", v4);
    return v4;
}

int main()
{
    HCRYPTPROV phProv;
    void *Src;
    BYTE a2[16] = {65, 109, 33, 49, 66, 111, 98, 50, 68, 67, 99, 52, 64, 35, 113, 51}; // byte_420960
    char v7[32];
    size_t Size;
    BYTE *pbData;
    HCRYPTKEY phKey;

    Src = (void *)sub_402820(phProv, a2);
    // for (int i = 0; i < 32; i++)
    // {
    //     printf("Src: %d\n", ((int *)Src)[i]);
    // }

    Size = 0x10; // dword_420000;
    memmove(v7, Src, Size);

    CryptImportKey(phProv, pbData, 0x2Cu, 0, 0, &phKey);

    // printf("v7: %d\n", v7);
}
